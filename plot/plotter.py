import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

# Before extra train
language_dict = {
    'EN': {
        'EN': 0.9640117740583977,
        'DE': 0.8689292724624834,
        'NL': 0.8742778016521033,
        'ES': 0.8574659262998485,
        'PT': 0.7854943221915699,
        'FR': 0.8365050557428053,
        'PL': 0.8029583696670218,
        'HU': 0.7818433966289737,
        'FI': 0.7395133100295779
    },
    'DE': {
        'EN': 0.8427957963790165,
        'DE': 0.9470379556085768,
        'NL': 0.8708398987728598,
        'ES': 0.8492179986840107,
        'PT': 0.8612139039124522,
        'FR': 0.8438370293965962,
        'PL': 0.8153079812357937,
        'HU': 0.8227371546741608,
        'FI': 0.7290174257821611
    },
    'NL': {
        'EN': 0.7977311550085411,
        'DE': 0.847593155285463,
        'NL': 0.9698298460511893,
        'ES': 0.8622651441528993,
        'PT': 0.7599103925197234,
        'FR': 0.8301867111713779,
        'PL': 0.8023437374241424,
        'HU': 0.7997239768565211,
        'FI': 0.7475871313672922
    },
    'ES': {
        'EN': 0.8118544932704225,
        'DE': 0.8150243096380565,
        'NL': 0.8575389616598145,
        'ES': 0.988576327279252,
        'PT': 0.8105681341041957,
        'FR': 0.8759962736776732,
        'PL': 0.8405415811088295,
        'HU': 0.7851717128490425,
        'FI': 0.7326493663246831
    },
    'PT': {
        'EN': 0.8142449649926528,
        'DE': 0.8235852339227533,
        'NL': 0.8558028236420196,
        'ES': 0.9079380978614714,
        'PT': 0.9841438126568859,
        'FR': 0.912218025926304,
        'PL': 0.8023240883410375,
        'HU': 0.7766172865821166,
        'FI': 0.7181575433911882
    },
    'FR': {
        'EN': 0.7926393728222996,
        'DE': 0.8728064638303245,
        'NL': 0.8632715459583413,
        'ES': 0.9130652060928316,
        'PT': 0.901550689628302,
        'FR': 0.9792746113989638,
        'PL': 0.8322337266233246,
        'HU': 0.7788271703751135,
        'FI': 0.7375192655632247
    },
    'PL': {
        'EN': 0.6829857299670692,
        'DE': 0.7400418612139752,
        'NL': 0.7034395153410201,
        'ES': 0.7429972493793074,
        'PT': 0.6140790115428385,
        'FR': 0.6766153187847668,
        'PL': 0.9863153692614771,
        'HU': 0.6679772594442378,
        'FI': 0.7363879598662209
    },
    'HU': {
        'EN': 0.5413768181407534,
        'DE': 0.670912535110066,
        'NL': 0.6137708177976635,
        'ES': 0.5769169843599844,
        'PT': 0.5877121123464014,
        'FR': 0.522963533359001,
        'PL': 0.6629243077733513,
        'HU': 0.9392957671676668,
        'FI': 0.6967941810344828
    },
    'FI': {
        'EN': 0.6489266547406084,
        'DE': 0.6923982729294779,
        'NL': 0.6754182500123377,
        'ES': 0.6212167201456943,
        'PT': 0.5778745968218586,
        'FR': 0.6027397260273972,
        'PL': 0.7228251905123215,
        'HU': 0.6890865697548274,
        'FI': 0.9425851603701616
    }
}

# After train
# language_dict = {
#     'EN': {
#         'EN': 0.9644637332416638,
#         'DE': 0.8783664180048046,
#         'NL': 0.8773873185637892,
#         'ES': 0.8739835762015941,
#         'PT': 0.7938002369744133,
#         'FR': 0.8450354426450044,
#         'PL': 0.8263579123657386,
#         'HU': 0.7859009225190636,
#         'FI': 0.7494629430719657
#     },
#     'DE': {
#         'EN': 0.8543003574658684,
#         'DE': 0.9482309358616143,
#         'NL': 0.8737530428141855,
#         'ES': 0.8729130351547151,
#         'PT': 0.8780949078816724,
#         'FR': 0.8672348290378888,
#         'PL': 0.8307296689167472,
#         'HU': 0.8278971095200212,
#         'FI': 0.7418237527476186
#     },
#     'NL': {
#         'EN': 0.8308996088657106,
#         'DE': 0.8503931973658974,
#         'NL': 0.9710227814317033,
#         'ES': 0.8835815474028333,
#         'PT': 0.7739057075180896,
#         'FR': 0.8447792207792209,
#         'PL': 0.8183132530120483,
#         'HU': 0.8045842839709239,
#         'FI': 0.7540906809436173
#     },
#     'ES': {
#         'EN': 0.8201120229256219,
#         'DE': 0.8321622738689473,
#         'NL': 0.8621695271788498,
#         'ES': 0.98839689786479,
#         'PT': 0.813483291110645,
#         'FR': 0.8802069857697284,
#         'PL': 0.8461698818171614,
#         'HU': 0.7967948717948717,
#         'FI': 0.7399866041527127
#     },
#     'PT': {
#         'EN': 0.819059967585089,
#         'DE': 0.8441931714096207,
#         'NL': 0.8602057908590571,
#         'ES': 0.9125573566834312,
#         'PT': 0.9843616009479706,
#         'FR': 0.9186788503752106,
#         'PL': 0.8100603492552646,
#         'HU': 0.7825161049885534,
#         'FI': 0.7240919693435521
#     },
#     'FR': {
#         'EN': 0.808360100703186,
#         'DE': 0.880010091135568,
#         'NL': 0.8649268712360194,
#         'ES': 0.9234720903503073,
#         'PT': 0.9087508183433611,
#         'FR': 0.9794259588519176,
#         'PL': 0.8454329546183965,
#         'HU': 0.7867611789159517,
#         'FI': 0.7446687422583776
#     },
#     'PL': {
#         'EN': 0.7245130724688543,
#         'DE': 0.7545775778991328,
#         'NL': 0.7257946745850168,
#         'ES': 0.7977691066211771,
#         'PT': 0.6415192254674602,
#         'FR': 0.7199192176870748,
#         'PL': 0.9862523750977982,
#         'HU': 0.6760518487037824,
#         'FI': 0.74402753182532
#     },
#     'HU': {
#         'EN': 0.7094936289556787,
#         'DE': 0.7260167347733022,
#         'NL': 0.6864282214600685,
#         'ES': 0.726170546827072,
#         'PT': 0.6346443903004988,
#         'FR': 0.6590872526411756,
#         'PL': 0.7503723221445756,
#         'HU': 0.9394518801784577,
#         'FI': 0.7337777628890155
#     },
#     'FI': {
#         'EN': 0.708781920099653,
#         'DE': 0.7168052159739201,
#         'NL': 0.7089629374415514,
#         'ES': 0.7115673670408391,
#         'PT': 0.6317202046464815,
#         'FR': 0.6683076249863255,
#         'PL': 0.7755781502456222,
#         'HU': 0.7065117535801134,
#         'FI': 0.9425965843143759
#     }
# }

def dist_func(val):
    return 1 - val


def plot_scatter(df_dict):
    fig, ax = plt.subplots(nrows=3, ncols=3)
    i = 0

    for row in ax:
        for cell in row:
            lang_from = list(df_dict.keys())[i]
            cell.scatter(0, 0, marker='o', color='green')
            # cell.grid(which='both')
            # cell.set_xlim([-5, 5])
            # cell.set_ylim([-5, 5])
            cell.set_title(lang_from)
            cell.set_aspect('equal')
            cell.axes.get_xaxis().set_ticks([])
            cell.axes.get_yaxis().set_ticks([])

            for x, y, name in df_dict[lang_from].values:
                cell.plot([0, x], [0, y], 'k--', lw=0.5)
                # cell.scatter(x+0.2, y+0.2, facecolors='none', edgecolors='r', s=150)
                cell.text(x, y, name, fontsize=8, color='red')

            i += 1

    plt.show()


def make_df_dict(l_dict):
    n_lang = len(l_dict.keys())
    df_dict = dict()

    for lang_from in l_dict:
        i = 0
        df = pd.DataFrame(columns=['x', 'y', 'lang'])

        for lang_to in l_dict[lang_from]:
            alpha = (2 * np.pi / n_lang) * i
            val = l_dict[lang_from][lang_to]

            dist = dist_func(val)
            x = dist * np.cos(alpha)
            y = dist * np.sin(alpha)

            df = df.append({'x': x, 'y': y, 'lang': lang_to}, ignore_index=True)
            i += 1

        df_dict[lang_from] = df

    return df_dict


print("Order From -> To:")
for language_from in language_dict:
    ordered = list({k: v for k, v in sorted(language_dict[language_from].items(), key=lambda item: item[1], reverse=True)}.keys())
    print(f"{language_from}: {ordered}")

to_from_dict = {}
for language_from in language_dict:
    for language_to in language_dict:
        if language_to not in to_from_dict:
            to_from_dict[language_to] = dict()
        to_from_dict[language_to][language_from] = language_dict[language_from][language_to]

print("Order To -> From:")
for language_to in to_from_dict:
    ordered = list({k: v for k, v in sorted(to_from_dict[language_to].items(), key=lambda item: item[1], reverse=True)}.keys())
    print(f"{language_to}: {ordered}")

df_dict = make_df_dict(language_dict)
df_to_from_dict = make_df_dict(to_from_dict)
# plot_scatter(df_dict)
plot_scatter(df_to_from_dict)
